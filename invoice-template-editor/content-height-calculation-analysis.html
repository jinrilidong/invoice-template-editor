<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å†…å®¹æ€»é«˜åº¦è®¡ç®—åˆ†æ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        .analysis-container {
            max-width: 900px;
            margin: 0 auto;
        }
        .section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .section-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        .calculation-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        .calculation-value {
            font-weight: bold;
            color: #2563eb;
        }
        .calculation-box {
            background-color: #fef3c7;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .code-block {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            border-left: 4px solid #2563eb;
        }
        .highlight {
            background-color: #fef3c7;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .formula {
            background-color: #e0f2fe;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #0288d1;
        }
        .table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        .table th, .table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .table th {
            background-color: #f5f5f5;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="analysis-container">
        <h1>å†…å®¹æ€»é«˜åº¦è®¡ç®—åˆ†æ</h1>
        
        <div class="section">
            <div class="section-title">ğŸ” å†…å®¹é«˜åº¦è®¡ç®—çš„ä¸¤ä¸ªä¸»è¦å‡½æ•°</div>
            
            <h3>1. getAllContentElements() - ç²¾ç¡®è®¡ç®—</h3>
            <p>è¿™ä¸ªå‡½æ•°å°†å†…å®¹åˆ†è§£ä¸ºç‹¬ç«‹çš„å…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰æ˜ç¡®çš„é«˜åº¦å€¼ï¼š</p>
            
            <div class="code-block">
const getAllContentElements = () => {
  const elements = []
  
  // Header Section
  if (props.sectionStates.header) {
    elements.push({
      type: 'header',
      height: 48,  // å›ºå®š48px
      content: 'header'
    })
  }
  
  // Info Section
  if (props.sectionStates.info && props.templateData.info?.items) {
    elements.push({
      type: 'info',
      height: props.templateData.info.items.length * 20,  // æ¯ä¸ªitem 20px
      content: 'info'
    })
  }
  
  // Table Section
  if (props.sectionStates.table && props.templateData.tables?.length > 0) {
    const table = props.templateData.tables[0]
    const allRows = getTableRows(table)
    
    // è¡¨æ ¼å¤´éƒ¨
    elements.push({
      type: 'table-header',
      height: 40,  // å›ºå®š40px
      content: 'table-header'
    })
    
    // æ¯ä¸€è¡Œ
    allRows.forEach((row, index) => {
      elements.push({
        type: 'table-row',
        height: 15,  // æ¯è¡Œ15px
        content: row,
        rowIndex: index
      })
    })
  }
  
  // Description Section
  if (props.sectionStates.description && props.templateData.description?.content) {
    const contentLength = props.templateData.description.content.length
    elements.push({
      type: 'description',
      height: Math.ceil(contentLength / 100) * 20,  // æ¯100å­—ç¬¦20px
      content: 'description'
    })
  }
  
  // Item Section
  if (props.sectionStates.item && props.templateData.item?.items) {
    elements.push({
      type: 'item',
      height: props.templateData.item.items.length * 20,  // æ¯ä¸ªitem 20px
      content: 'item'
    })
  }
  
  return elements
}
            </div>

            <h3>2. getEstimatedHeight() - ä¼°ç®—è®¡ç®—</h3>
            <p>è¿™ä¸ªå‡½æ•°æä¾›å¿«é€Ÿçš„é«˜åº¦ä¼°ç®—ï¼Œç”¨äºæ€§èƒ½ä¼˜åŒ–ï¼š</p>
            
            <div class="code-block">
const getEstimatedHeight = () => {
  let estimatedHeight = 0
  
  // Header section height (approximately 48px)
  if (props.sectionStates.header) {
    estimatedHeight += 48
  }
  
  // Info section height (approximately 20px per item)
  if (props.sectionStates.info && props.templateData.info?.items) {
    estimatedHeight += props.templateData.info.items.length * 20
  }
  
  // Table section height (approximately 15px per row)
  if (props.sectionStates.table && props.templateData.tables?.length > 0) {
    props.templateData.tables.forEach((table) => {
      const rowsCount = getTableRows(table).length
      estimatedHeight += 40 + (rowsCount * 15)  // 40px for header + 15px per row
    })
  }
  
  // Description section height (approximately 20px per 100 characters)
  if (props.sectionStates.description && props.templateData.description?.content) {
    const contentLength = props.templateData.description.content.length
    estimatedHeight += Math.ceil(contentLength / 100) * 20
  }
  
  // Item section height (approximately 20px per item)
  if (props.sectionStates.item && props.templateData.item?.items) {
    estimatedHeight += props.templateData.item.items.length * 20
  }
  
  // Footer section height (approximately 30px)
  if (props.sectionStates.footer) {
    estimatedHeight += 30
  }
  
  // Add padding and margins (approximately 100px)
  estimatedHeight += 100
  
  return estimatedHeight
}
            </div>
        </div>

        <div class="section">
            <div class="section-title">ğŸ“Š å„Sectioné«˜åº¦è®¡ç®—è§„åˆ™</div>
            
            <table class="table">
                <tr>
                    <th>Sectionç±»å‹</th>
                    <th>é«˜åº¦è®¡ç®—è§„åˆ™</th>
                    <th>ç¤ºä¾‹</th>
                    <th>è¯´æ˜</th>
                </tr>
                <tr>
                    <td>Header Section</td>
                    <td>å›ºå®š 48px</td>
                    <td>48px</td>
                    <td>h-12 = 3rem = 48px</td>
                </tr>
                <tr>
                    <td>Info Section</td>
                    <td>itemsæ•°é‡ Ã— 20px</td>
                    <td>3ä¸ªitems = 60px</td>
                    <td>æ¯ä¸ªinfo itemçº¦20pxé«˜åº¦</td>
                </tr>
                <tr>
                    <td>Table Section</td>
                    <td>40px + (è¡Œæ•° Ã— 15px)</td>
                    <td>5è¡Œ = 40 + 75 = 115px</td>
                    <td>è¡¨å¤´40px + æ¯è¡Œ15px</td>
                </tr>
                <tr>
                    <td>Description Section</td>
                    <td>Math.ceil(å­—ç¬¦æ•°/100) Ã— 20px</td>
                    <td>250å­—ç¬¦ = 3 Ã— 20 = 60px</td>
                    <td>æ¯100å­—ç¬¦çº¦20pxé«˜åº¦</td>
                </tr>
                <tr>
                    <td>Item Section</td>
                    <td>itemsæ•°é‡ Ã— 20px</td>
                    <td>2ä¸ªitems = 40px</td>
                    <td>æ¯ä¸ªitemçº¦20pxé«˜åº¦</td>
                </tr>
                <tr>
                    <td>Footer Section</td>
                    <td>å›ºå®š 30px (ä¼°ç®—)</td>
                    <td>30px</td>
                    <td>h-2.25 = 9pxï¼Œä½†ä¼°ç®—ä¸º30px</td>
                </tr>
            </table>
        </div>

        <div class="section">
            <div class="section-title">ğŸ§® å®é™…è®¡ç®—ç¤ºä¾‹</div>
            
            <div class="calculation-box">
                <h4>å‡è®¾å†…å®¹é…ç½®ï¼š</h4>
                <ul>
                    <li>Header: å¯ç”¨</li>
                    <li>Info: 3ä¸ªitems</li>
                    <li>Table: 1ä¸ªtableï¼Œ5è¡Œæ•°æ®</li>
                    <li>Description: 250å­—ç¬¦å†…å®¹</li>
                    <li>Item: 2ä¸ªitems</li>
                    <li>Footer: å¯ç”¨</li>
                </ul>
                
                <h4>getAllContentElements() ç²¾ç¡®è®¡ç®—ï¼š</h4>
                <div class="calculation-item">
                    <span>Headerå…ƒç´ :</span>
                    <span class="calculation-value">48px</span>
                </div>
                <div class="calculation-item">
                    <span>Infoå…ƒç´  (3 Ã— 20px):</span>
                    <span class="calculation-value">60px</span>
                </div>
                <div class="calculation-item">
                    <span>Table Headerå…ƒç´ :</span>
                    <span class="calculation-value">40px</span>
                </div>
                <div class="calculation-item">
                    <span>Table Rowå…ƒç´  (5 Ã— 15px):</span>
                    <span class="calculation-value">75px</span>
                </div>
                <div class="calculation-item">
                    <span>Descriptionå…ƒç´  (Math.ceil(250/100) Ã— 20px):</span>
                    <span class="calculation-value">60px</span>
                </div>
                <div class="calculation-item">
                    <span>Itemå…ƒç´  (2 Ã— 20px):</span>
                    <span class="calculation-value">40px</span>
                </div>
                <div class="calculation-item">
                    <span><strong>æ€»é«˜åº¦ (getAllContentElements):</strong></span>
                    <span class="calculation-value"><strong>323px</strong></span>
                </div>
                
                <h4>getEstimatedHeight() ä¼°ç®—è®¡ç®—ï¼š</h4>
                <div class="calculation-item">
                    <span>Header (48px):</span>
                    <span class="calculation-value">48px</span>
                </div>
                <div class="calculation-item">
                    <span>Info (3 Ã— 20px):</span>
                    <span class="calculation-value">60px</span>
                </div>
                <div class="calculation-item">
                    <span>Table (40px + 5 Ã— 15px):</span>
                    <span class="calculation-value">115px</span>
                </div>
                <div class="calculation-item">
                    <span>Description (Math.ceil(250/100) Ã— 20px):</span>
                    <span class="calculation-value">60px</span>
                </div>
                <div class="calculation-item">
                    <span>Item (2 Ã— 20px):</span>
                    <span class="calculation-value">40px</span>
                </div>
                <div class="calculation-item">
                    <span>Footer (30px):</span>
                    <span class="calculation-value">30px</span>
                </div>
                <div class="calculation-item">
                    <span>Paddingå’ŒMargins (100px):</span>
                    <span class="calculation-value">100px</span>
                </div>
                <div class="calculation-item">
                    <span><strong>æ€»é«˜åº¦ (getEstimatedHeight):</strong></span>
                    <span class="calculation-value"><strong>453px</strong></span>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">âš™ï¸ åˆ†é¡µè®¡ç®—é€»è¾‘</div>
            
            <div class="formula">
                <h4>åˆ†é¡µæ¡ä»¶ï¼š</h4>
                <p><strong>å½“å†…å®¹é«˜åº¦ > (å†…å®¹åŒºåŸŸé«˜åº¦ - Footeré«˜åº¦ - åº•è¾¹è·è¦æ±‚) æ—¶è§¦å‘åˆ†é¡µ</strong></p>
                <p>å³ï¼š<span class="highlight">å†…å®¹é«˜åº¦ > 723px - 9px - 10px = 704px</span></p>
            </div>
            
            <div class="code-block">
// åˆ†é¡µè®¡ç®—é€»è¾‘
const maxHeightPerPage = 723  // å†…å®¹åŒºåŸŸé«˜åº¦
const bottomMargin = 10       // åº•è¾¹è·è¦æ±‚
const footerHeight = 9        // Footeré«˜åº¦

// æ£€æŸ¥æ˜¯å¦éœ€è¦åˆ†é¡µ
const remainingHeight = maxHeightPerPage - footerHeight - currentHeight - element.height
if (currentHeight + element.height > maxHeightPerPage - footerHeight || remainingHeight < bottomMargin) {
  // è§¦å‘åˆ†é¡µ
  pages++
  currentPageHeight = element.height
}
            </div>
        </div>

        <div class="section">
            <div class="section-title">ğŸ¯ å…³é”®å‘ç°</div>
            
            <div class="calculation-box">
                <h4>ä¸¤ç§è®¡ç®—æ–¹æ³•çš„åŒºåˆ«ï¼š</h4>
                <ul>
                    <li><strong>getAllContentElements():</strong> ç²¾ç¡®è®¡ç®—ï¼Œç”¨äºåˆ†é¡µé€»è¾‘</li>
                    <li><strong>getEstimatedHeight():</strong> å¿«é€Ÿä¼°ç®—ï¼ŒåŒ…å«é¢å¤–çš„padding/margin</li>
                    <li><strong>åˆ†é¡µä½¿ç”¨:</strong> getAllContentElements() çš„ç²¾ç¡®è®¡ç®—</li>
                    <li><strong>æ€§èƒ½ä¼˜åŒ–:</strong> getEstimatedHeight() ç”¨äºå¿«é€Ÿé¢„åˆ¤</li>
                </ul>
                
                <h4>é«˜åº¦è®¡ç®—ç‰¹ç‚¹ï¼š</h4>
                <ul>
                    <li>Table Sectionè¢«åˆ†è§£ä¸ºå¤šä¸ªç‹¬ç«‹å…ƒç´ ï¼ˆheader + rowsï¼‰</li>
                    <li>Description Sectionæ ¹æ®å­—ç¬¦æ•°åŠ¨æ€è®¡ç®—é«˜åº¦</li>
                    <li>Infoå’ŒItem Sectionæ ¹æ®æ•°é‡åŠ¨æ€è®¡ç®—é«˜åº¦</li>
                    <li>Header Sectionä½¿ç”¨å›ºå®šé«˜åº¦</li>
                    <li>æ‰€æœ‰è®¡ç®—éƒ½è€ƒè™‘äº†å®é™…çš„å†…å®¹æ•°æ®</li>
                </ul>
            </div>
        </div>
    </div>
</body>
</html>









