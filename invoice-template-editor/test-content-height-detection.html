<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å†…å®¹é«˜åº¦æ£€æµ‹æµ‹è¯• - å¦‚ä½•åˆ¤æ–­æ˜¯å¦è¶…è¿‡700px</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        .test-steps {
            margin: 10px 0;
        }
        .test-step {
            margin: 5px 0;
            padding: 5px;
            background-color: #f5f5f5;
            border-radius: 3px;
        }
        .expected-result {
            color: #0066cc;
            font-weight: bold;
        }
        .debug-info {
            background-color: #fff3cd;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .fix-details {
            background-color: #e8f5e8;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .code-block {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>å†…å®¹é«˜åº¦æ£€æµ‹æµ‹è¯• - å¦‚ä½•åˆ¤æ–­æ˜¯å¦è¶…è¿‡700px</h1>
        
        <div class="fix-details">
            <h2>ğŸ”§ å†…å®¹é«˜åº¦æ£€æµ‹æ–¹æ³•</h2>
            <p>ç³»ç»Ÿä½¿ç”¨å¤šç§æ–¹æ³•æ¥åˆ¤æ–­å†…å®¹æ˜¯å¦è¶…è¿‡700pxï¼š</p>
            
            <h3>1. å®é™…é«˜åº¦æµ‹é‡ (ResizeObserver)</h3>
            <div class="code-block">
// ä½¿ç”¨ResizeObserverç›‘æ§å†…å®¹é«˜åº¦å˜åŒ–
const observeContentHeight = () => {
  resizeObserver = new ResizeObserver((entries) => {
    for (const entry of entries) {
      const height = entry.contentRect.height
      actualContentHeight.value = height
      
      console.log('Content height changed', {
        actualHeight: height,
        maxHeight: 700,
        isOverflowing: height > 700
      })
    }
  })
  
  resizeObserver.observe(containerRef.value)
}
            </div>
            
            <h3>2. ä¼°ç®—é«˜åº¦è®¡ç®—</h3>
            <div class="code-block">
// ä¼°ç®—å„éƒ¨åˆ†é«˜åº¦
const getEstimatedHeight = () => {
  let estimatedHeight = 0
  
  // Header: 48px
  if (props.sectionStates.header) estimatedHeight += 48
  
  // Info: 20px per item
  if (props.sectionStates.info) estimatedHeight += items.length * 20
  
  // Table: 40px + 15px per row
  if (props.sectionStates.table) estimatedHeight += 40 + (rowsCount * 15)
  
  // Description: 20px per 100 characters
  if (props.sectionStates.description) estimatedHeight += Math.ceil(contentLength / 100) * 20
  
  // Item: 20px per item
  if (props.sectionStates.item) estimatedHeight += items.length * 20
  
  // Footer: 30px
  if (props.sectionStates.footer) estimatedHeight += 30
  
  // Padding: 100px
  estimatedHeight += 100
  
  return estimatedHeight
}
            </div>
            
            <h3>3. åˆ†é¡µåˆ¤æ–­é€»è¾‘</h3>
            <div class="code-block">
// æ£€æŸ¥å†…å®¹æ˜¯å¦è¶…è¿‡700px
const isContentOverflowing = computed(() => {
  return actualContentHeight.value > 700
})

// è®¡ç®—æ€»é¡µæ•°
const totalPages = computed(() => {
  const contentHeight = actualContentHeight.value > 0 ? 
    actualContentHeight.value : getEstimatedHeight()
  const pages = Math.ceil(contentHeight / 700)
  return Math.max(1, pages)
})
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">æµ‹è¯•åœºæ™¯ 1: å®é™…é«˜åº¦ç›‘æ§</div>
            <div class="test-steps">
                <div class="test-step">1. æ‰“å¼€åº”ç”¨ç¨‹åº (http://localhost:5174/)</div>
                <div class="test-step">2. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„ Console æ ‡ç­¾</div>
                <div class="test-step">3. ä¿®æ”¹ Table Rows Number è¾“å…¥æ¡†</div>
                <div class="test-step">4. è§‚å¯Ÿæ§åˆ¶å°è¾“å‡ºçš„é«˜åº¦ä¿¡æ¯</div>
            </div>
            <div class="expected-result">é¢„æœŸç»“æœ: æ§åˆ¶å°åº”è¯¥æ˜¾ç¤ºï¼š
                <ul>
                    <li><code>Content height changed</code> - å®é™…é«˜åº¦å˜åŒ–</li>
                    <li><code>actualHeight</code> - å®é™…æµ‹é‡çš„é«˜åº¦</li>
                    <li><code>isOverflowing</code> - æ˜¯å¦è¶…è¿‡700px</li>
                    <li><code>needsPagination</code> - æ˜¯å¦éœ€è¦åˆ†é¡µ</li>
                </ul>
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">æµ‹è¯•åœºæ™¯ 2: åˆ†é¡µè®¡ç®—æµ‹è¯•</div>
            <div class="test-steps">
                <div class="test-step">1. è®¾ç½® Table Rows Number ä¸º 5</div>
                <div class="test-step">2. è§‚å¯Ÿæ§åˆ¶å°çš„ <code>Total pages calculation</code> ä¿¡æ¯</div>
                <div class="test-step">3. è®¾ç½® Table Rows Number ä¸º 20</div>
                <div class="test-step">4. å†æ¬¡è§‚å¯Ÿåˆ†é¡µè®¡ç®—ä¿¡æ¯</div>
                <div class="test-step">5. è®¾ç½® Table Rows Number ä¸º 50</div>
                <div class="test-step">6. è§‚å¯Ÿå¤šé¡µåˆ†é¡µè®¡ç®—</div>
            </div>
            <div class="expected-result">é¢„æœŸç»“æœ: æ§åˆ¶å°åº”è¯¥æ˜¾ç¤ºï¼š
                <ul>
                    <li><code>actualHeight</code> - å®é™…é«˜åº¦ (å¦‚æœæœ‰)</li>
                    <li><code>estimatedHeight</code> - ä¼°ç®—é«˜åº¦</li>
                    <li><code>usedHeight</code> - ä½¿ç”¨çš„é«˜åº¦å€¼</li>
                    <li><code>calculatedPages</code> - è®¡ç®—çš„é¡µæ•°</li>
                    <li><code>isOverflowing</code> - æ˜¯å¦æº¢å‡º</li>
                </ul>
            </div>
        </div>

        <div class="debug-info">
            <h3>ğŸ› è°ƒè¯•ä¿¡æ¯è¯´æ˜</h3>
            <p>åœ¨æ§åˆ¶å°ä¸­ï¼Œæ‚¨ä¼šçœ‹åˆ°ä»¥ä¸‹è°ƒè¯•ä¿¡æ¯ï¼š</p>
            
            <h4>1. å†…å®¹é«˜åº¦å˜åŒ–ç›‘æ§</h4>
            <div class="code-block">
PdfPreviewPanel: Content height changed {
  actualHeight: 650,        // å®é™…æµ‹é‡çš„é«˜åº¦
  maxHeight: 700,          // æœ€å¤§é«˜åº¦é™åˆ¶
  isOverflowing: false,    // æ˜¯å¦è¶…è¿‡700px
  needsPagination: false   // æ˜¯å¦éœ€è¦åˆ†é¡µ
}
            </div>
            
            <h4>2. åˆ†é¡µè®¡ç®—ä¿¡æ¯</h4>
            <div class="code-block">
PdfPreviewPanel: Total pages calculation {
  actualHeight: 0,         // å®é™…é«˜åº¦ (0è¡¨ç¤ºæœªæµ‹é‡)
  estimatedHeight: 850,    // ä¼°ç®—é«˜åº¦
  usedHeight: 850,         // ä½¿ç”¨çš„é«˜åº¦å€¼
  maxHeightPerPage: 700,   // æ¯é¡µæœ€å¤§é«˜åº¦
  calculatedPages: 2,      // è®¡ç®—çš„é¡µæ•°
  isOverflowing: true      // æ˜¯å¦æº¢å‡º
}
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">æµ‹è¯•åœºæ™¯ 3: ä¸åŒå†…å®¹é‡çš„é«˜åº¦æµ‹è¯•</div>
            <div class="test-steps">
                <div class="test-step">1. æµ‹è¯•å°‘é‡å†…å®¹ (Rows = 1-5)</div>
                <div class="test-step">2. æµ‹è¯•ä¸­ç­‰å†…å®¹ (Rows = 10-15)</div>
                <div class="test-step">3. æµ‹è¯•å¤§é‡å†…å®¹ (Rows = 20-30)</div>
                <div class="test-step">4. æµ‹è¯•è¶…å¤§é‡å†…å®¹ (Rows = 50+)</div>
                <div class="test-step">5. è§‚å¯Ÿæ¯ç§æƒ…å†µä¸‹çš„é«˜åº¦è®¡ç®—å’Œåˆ†é¡µ</div>
            </div>
            <div class="expected-result">é¢„æœŸç»“æœ: 
                <ul>
                    <li>å°‘é‡å†…å®¹: é«˜åº¦ < 700pxï¼Œæ˜¾ç¤º 1 é¡µ</li>
                    <li>ä¸­ç­‰å†…å®¹: é«˜åº¦ â‰ˆ 700pxï¼Œæ˜¾ç¤º 1-2 é¡µ</li>
                    <li>å¤§é‡å†…å®¹: é«˜åº¦ > 700pxï¼Œæ˜¾ç¤º 2-3 é¡µ</li>
                    <li>è¶…å¤§é‡å†…å®¹: é«˜åº¦ >> 700pxï¼Œæ˜¾ç¤º 3+ é¡µ</li>
                </ul>
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">æµ‹è¯•åœºæ™¯ 4: å®æ—¶é«˜åº¦ç›‘æ§</div>
            <div class="test-steps">
                <div class="test-step">1. åœ¨ Table Rows Number è¾“å…¥æ¡†ä¸­è¾“å…¥æ•°å­—</div>
                <div class="test-step">2. ä½¿ç”¨ä¸Šä¸‹ç®­å¤´è°ƒæ•´æ•°å­—</div>
                <div class="test-step">3. è§‚å¯Ÿæ§åˆ¶å°ä¸­çš„å®æ—¶é«˜åº¦å˜åŒ–</div>
                <div class="test-step">4. éªŒè¯é«˜åº¦ç›‘æ§æ˜¯å¦å®æ—¶å“åº”</div>
            </div>
            <div class="expected-result">é¢„æœŸç»“æœ: æ¯æ¬¡è¾“å…¥å˜åŒ–éƒ½åº”è¯¥åœ¨æ§åˆ¶å°çœ‹åˆ°æ–°çš„é«˜åº¦è®¡ç®—ä¿¡æ¯</div>
        </div>

        <div class="fix-details">
            <h2>ğŸ“ æŠ€æœ¯å®ç°æ€»ç»“</h2>
            <p><strong>åˆ¤æ–­å†…å®¹æ˜¯å¦è¶…è¿‡700pxçš„æ–¹æ³•ï¼š</strong></p>
            <ol>
                <li><strong>ResizeObserver å®æ—¶ç›‘æ§</strong>ï¼šä½¿ç”¨æµè§ˆå™¨APIç›‘æ§DOMå…ƒç´ çš„å®é™…é«˜åº¦å˜åŒ–</li>
                <li><strong>ä¼°ç®—é«˜åº¦è®¡ç®—</strong>ï¼šåŸºäºå„éƒ¨åˆ†å†…å®¹çš„ä¼°ç®—é«˜åº¦è¿›è¡Œè®¡ç®—</li>
                <li><strong>æ··åˆåˆ¤æ–­</strong>ï¼šä¼˜å…ˆä½¿ç”¨å®é™…æµ‹é‡é«˜åº¦ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨ä¼°ç®—é«˜åº¦</li>
                <li><strong>åˆ†é¡µè®¡ç®—</strong>ï¼šæ ¹æ®æ€»é«˜åº¦é™¤ä»¥700pxè®¡ç®—éœ€è¦çš„é¡µæ•°</li>
                <li><strong>å®æ—¶æ›´æ–°</strong>ï¼šå†…å®¹å˜åŒ–æ—¶è‡ªåŠ¨é‡æ–°è®¡ç®—å’Œæ›´æ–°åˆ†é¡µ</li>
            </ol>
            
            <p><strong>å…³é”®é˜ˆå€¼ï¼š</strong></p>
            <ul>
                <li>æœ€å¤§å†…å®¹é«˜åº¦ï¼š<strong>700px</strong></li>
                <li>é¡µé¢æ€»é«˜åº¦ï¼š792px</li>
                <li>è¾¹è·å’Œå¡«å……ï¼š92px</li>
                <li>åˆ†é¡µè§¦å‘ï¼šå†…å®¹é«˜åº¦ > 700px</li>
            </ul>
        </div>
    </div>
</body>
</html>









