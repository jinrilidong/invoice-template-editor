<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML导出分页优化测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        .test-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            font-size: 18px;
        }
        .test-description {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .optimization-details {
            background-color: #e8f5e8;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .before-after {
            display: flex;
            gap: 20px;
            margin: 15px 0;
        }
        .before, .after {
            flex: 1;
            padding: 10px;
            border-radius: 5px;
        }
        .before {
            background-color: #ffe6e6;
            border: 1px solid #ffcccc;
        }
        .after {
            background-color: #e6ffe6;
            border: 1px solid #ccffcc;
        }
        .before-title, .after-title {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .before-title {
            color: #cc0000;
        }
        .after-title {
            color: #006600;
        }
        .test-steps {
            margin: 10px 0;
        }
        .test-step {
            margin: 8px 0;
            padding: 8px;
            background-color: #f5f5f5;
            border-radius: 3px;
            border-left: 4px solid #007bff;
        }
        .expected-result {
            color: #0066cc;
            font-weight: bold;
        }
        .code-example {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 14px;
            margin: 10px 0;
            border: 1px solid #e9ecef;
        }
        .highlight {
            background-color: #fff3cd;
            padding: 2px 4px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>HTML导出分页优化测试</h1>
        
        <div class="test-section">
            <div class="test-title">优化目标</div>
            <div class="test-description">
                优化HTML导出功能，使表格分页后的后续页面只显示：
                <ul>
                    <li>剩余数据行</li>
                    <li>小计</li>
                    <li>底部边框</li>
                </ul>
                而不显示标题、副标题和表头。
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">优化前后对比</div>
            
            <div class="before-after">
                <div class="before">
                    <div class="before-title">优化前（问题）</div>
                    <p>分页后的页面仍然显示：</p>
                    <ul>
                        <li>表格标题</li>
                        <li>副标题</li>
                        <li>表头</li>
                        <li>剩余数据行</li>
                        <li>小计</li>
                        <li>底部边框</li>
                    </ul>
                    <p><strong>问题：</strong>重复显示标题和表头，造成空间浪费和视觉混乱。</p>
                </div>
                
                <div class="after">
                    <div class="after-title">优化后（解决方案）</div>
                    <p>分页后的页面只显示：</p>
                    <ul>
                        <li><span class="highlight">剩余数据行</span></li>
                        <li><span class="highlight">小计</span></li>
                        <li><span class="highlight">底部边框</span></li>
                    </ul>
                    <p><strong>优势：</strong>节省空间，提高可读性，符合分页逻辑。</p>
                </div>
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">技术实现细节</div>
            
            <div class="optimization-details">
                <h4>1. 修改 splitTableSectionForHtml 函数</h4>
                <div class="code-example">
// 为第一部分添加显示控制属性
const firstPart = {
  ...section,
  content: {
    ...table,
    rowsNumber: firstPartRows,
    isFirstPart: true,
    showHeader: true,    // 显示标题、副标题、表头
    showSubtotal: false, // 不显示小计和边框
    showBorder: false
  }
}

// 为第二部分添加显示控制属性
const secondPart = {
  ...section,
  content: {
    ...table,
    rowsNumber: secondPartRows,
    startRowIndex: firstPartRows,
    isSecondPart: true,
    showHeader: false,   // 不显示标题、副标题、表头
    showSubtotal: true,  // 显示小计和边框
    showBorder: true
  }
}
                </div>

                <h4>2. 更新 generateTableSection 函数</h4>
                <div class="code-example">
// 根据分页状态决定是否显示标题和副标题
if (table.showHeader !== false) {
  html += `
    ${table.sectionTitle ? `&lt;span class="table-section-title"&gt;${table.sectionTitle}&lt;/span&gt;&lt;br/&gt;` : ''}
    ${table.subsectionTitle ? `&lt;span class="table-subsection-title"&gt;${table.subsectionTitle}&lt;/span&gt;&lt;br/&gt;` : ''}
  `
}

// 根据分页状态决定是否显示表头
if (table.showHeader !== false) {
  html += `&lt;thead&gt;...&lt;/thead&gt;`
}

// 根据分页状态决定是否显示小计
if (table.showSubtotal !== false) {
  html += `&lt;table class="subtotal-table"&gt;...&lt;/table&gt;`
}
                </div>
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">测试步骤</div>
            <div class="test-steps">
                <div class="test-step">
                    <strong>步骤 1：</strong>创建一个包含大量数据行的表格section
                </div>
                <div class="test-step">
                    <strong>步骤 2：</strong>设置表格行数超过单页可容纳的数量
                </div>
                <div class="test-step">
                    <strong>步骤 3：</strong>触发HTML导出功能
                </div>
                <div class="test-step">
                    <strong>步骤 4：</strong>检查分页后的第二页内容
                </div>
                <div class="test-step">
                    <strong>步骤 5：</strong>验证第二页只显示剩余数据行、小计和底部边框
                </div>
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">预期结果</div>
            <div class="expected-result">
                ✅ 分页后的页面应该：
                <ul>
                    <li>不显示表格标题和副标题</li>
                    <li>不显示表头（thead）</li>
                    <li>只显示剩余的数据行（tbody）</li>
                    <li>显示小计行</li>
                    <li>显示底部边框</li>
                </ul>
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">验证方法</div>
            <div class="test-description">
                <p><strong>1. 代码审查：</strong>检查 splitTableSectionForHtml 和 generateTableSection 函数的修改</p>
                <p><strong>2. 功能测试：</strong>在应用中创建大表格并导出HTML</p>
                <p><strong>3. 视觉验证：</strong>检查导出的HTML文件，确认分页后的页面布局</p>
                <p><strong>4. 浏览器测试：</strong>在浏览器中打开导出的HTML，验证分页效果</p>
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">相关文件</div>
            <div class="code-example">
修改的文件：
- /src/App.vue (splitTableSectionForHtml 函数)
- /src/App.vue (generateTableSection 函数)

测试文件：
- test-html-pagination-optimization.html (本文件)
            </div>
        </div>
    </div>
</body>
</html>
















